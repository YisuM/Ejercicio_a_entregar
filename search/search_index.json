{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"INDICE Esta pagina web explica el proceso de enrutamiento o routing en una red privada Routing estatico Uso recomendado Se utiliza principalmente en redes no muy grandes y que no van a escalar mucho en extension durante el tiempo Ideas principales Las rutas estaticas se configuran manualmente por el administrador de esa red. Para adicionar una nueva ruta estatica, hay que especificar el siguiente salto con el comando ip route ip_actual mascara ip_siguiente_salto ```markdown ip route 192.168.3.4 255.255.255.128 192.168.3.2 ``` OJO: Las ips son orientativas, no se corresponden necesariamente al ejercicio. Routing dinamico Uso recomendado Se suele utilizar para grandes redes, o bien, que van a escalar en numero en un corto periodo de tiempo Ideas principales En este ejercicio utilizaremos el protocolo de encaminamiento dinamico OSPF ( Open Shortest Path First ) Siempre usaremos un solo area: area 0","title":"Inicio"},{"location":"#indice","text":"Esta pagina web explica el proceso de enrutamiento o routing en una red privada","title":"INDICE"},{"location":"#routing-estatico","text":"","title":"Routing estatico"},{"location":"#uso-recomendado","text":"Se utiliza principalmente en redes no muy grandes y que no van a escalar mucho en extension durante el tiempo","title":"Uso recomendado"},{"location":"#ideas-principales","text":"Las rutas estaticas se configuran manualmente por el administrador de esa red. Para adicionar una nueva ruta estatica, hay que especificar el siguiente salto con el comando ip route ip_actual mascara ip_siguiente_salto ```markdown ip route 192.168.3.4 255.255.255.128 192.168.3.2 ``` OJO: Las ips son orientativas, no se corresponden necesariamente al ejercicio.","title":"Ideas principales"},{"location":"#routing-dinamico","text":"","title":"Routing dinamico"},{"location":"#uso-recomendado_1","text":"Se suele utilizar para grandes redes, o bien, que van a escalar en numero en un corto periodo de tiempo","title":"Uso recomendado"},{"location":"#ideas-principales_1","text":"En este ejercicio utilizaremos el protocolo de encaminamiento dinamico OSPF ( Open Shortest Path First ) Siempre usaremos un solo area: area 0","title":"Ideas principales"},{"location":"Dinamico/","text":"Enrutamiento dinamico Routing En todos los router menos en el frontera Confirmar ipv6 routing Activar OSPF Elegir un router-id R(config)#ipv6 unicast-routing R(config)#ipv6 router ospf 1 %OSPFv3-4-NORTRID: OSPFv3 process 1 could not pick a router-id,please configure manually R(config-rtr)#router-id 1.1.1.1 R(config-rtr)#exi R(config)# Y en cada interfaz del router R(config)# interface gigabitEthernet 0/0 R(config-if)# ipv6 ospf 1 area 0 R(config-if)# exit R(config)# \u2026 En el router frontera A tener en cuenta: A\u00f1adir ruta por defecto salida ISP (igual est\u00e1tico) OSPF: Distribuir ruta por defecto (default-information originate ) OSPF: No a\u00f1adir el interfaz del ISP central(config)# ipv6 router ospf 1 %OSPFv3-4-NORTRID: OSPFv3 process 1 could not pick a router-id,please configure manually central(config-rtr)# router-id 4.4.4.4 central(config-rtr)# default-information originate En el ISP: Igual que en estatico.","title":"**Enrutamiento dinamico**"},{"location":"Dinamico/#enrutamiento-dinamico","text":"","title":"Enrutamiento dinamico"},{"location":"Dinamico/#routing","text":"","title":"Routing"},{"location":"Dinamico/#en-todos-los-router-menos-en-el-frontera","text":"Confirmar ipv6 routing Activar OSPF Elegir un router-id R(config)#ipv6 unicast-routing R(config)#ipv6 router ospf 1 %OSPFv3-4-NORTRID: OSPFv3 process 1 could not pick a router-id,please configure manually R(config-rtr)#router-id 1.1.1.1 R(config-rtr)#exi R(config)# Y en cada interfaz del router R(config)# interface gigabitEthernet 0/0 R(config-if)# ipv6 ospf 1 area 0 R(config-if)# exit R(config)# \u2026","title":"En todos los router menos en el frontera"},{"location":"Dinamico/#en-el-router-frontera","text":"A tener en cuenta: A\u00f1adir ruta por defecto salida ISP (igual est\u00e1tico) OSPF: Distribuir ruta por defecto (default-information originate ) OSPF: No a\u00f1adir el interfaz del ISP central(config)# ipv6 router ospf 1 %OSPFv3-4-NORTRID: OSPFv3 process 1 could not pick a router-id,please configure manually central(config-rtr)# router-id 4.4.4.4 central(config-rtr)# default-information originate En el ISP: Igual que en estatico.","title":"En el router frontera"},{"location":"Estatico/","text":"Enrutamiento estatico Ejemplo : Comandos config routing ANTES QUE TODO: ANOTAR LAS SUBREDES Y LAS DIRECCIONES IPs DE CADA LAN. En el router izquierdo (Jerez) configurar las interfaces gigabit seg\u00fan su correspondiente LAN Jerez Router>ena Jerez Router#conf terminal Jerez Router(config)#hostname Jerez Jerez Jerez(config)#interface gigabitEthernet 0/0 Jerez Jerez(config-if)#ip address 192.168.1.1 255.255.255.128 Jerez Jerez(config-if)#description LAN Cuartillo Jerez Jerez(config-if)#no shutdown Jerez Jerez(config-if)#interface gigabitEthernet 0/1 Jerez Jerez(config-if)#ip address 192.168.1.129 255.255.255.128 Jerez Jerez(config-if)#description LAN San Isidro Jerez Jerez(config-if)#no shutdown Jerez Jerez(config-if)#end Jerez Jerez#sh run Jerez Jerez#sh ip route Probamos algunos Ping hacia los host de las 2 LANs para comprobar la configuraci\u00f3n Jerez Jerez#ping 192.168.1.2 Jerez Jerez#ping 192.168.1.130 Jerez Jerez#sh ip route A continuaci\u00f3n, configuramos el router derecho (Granada) Granada Router>ena Granada Router#conf ter Granada Router(config)#hostname Granada Granada Granada(config)#interface gigabitEthernet 0/0 Granada Granada(config-if)#description Sierra Nevada Granada Granada(config-if)#ip address 192.168.2.1 255.255.255.128 Granada Granada(config-if)#no shutdown Granada Granada(config-if)#interface gigabitEthernet 0/1 Granada Granada(config-if)#description Generalife Granada Granada(config-if)#ip address 192.168.2.129 255.255.255.128 Granada Granada(config-if)#no shutdown Granada Granada(config-if)#end Granada Granada#sh running-config Granada Granada#sh ip route Ahora es el turno de la LAN entre los dos routers (el enlace punto a punto). Tenemos que configurar los dos extremos, uno en el router de Jerez y el otro en el de Granada Jerez Jerez#conf terminal Jerez Jerez(config)#interface serial 0/0/0 Jerez Jerez(config-if)#ip address 192.168.3.1 255.255.255.252 Jerez Jerez(config-if)#description Serial Jerez<->Granada Jerez Jerez(config-if)#no shutdown Jerez Jerez(config-if)#end Jerez Jerez#sh running-config Granada Granada#conf terminal Granada Granada(config)#interface serial 0/0/0 Granada Granada(config-if)#ip address 192.168.3.2 255.255.255.252 Granada Granada(config-if)#description Serial Granada-Jerez Granada Granada(config-if)#no shutdown Granada Granada(config-if)#end Granada Granada#sh ip route Ping al router de Granada Jerez Jerez#ping 192.168.3.2 Jerez Jerez#sh ip route Ping a uno de lo hosts de una LAN de Granada Jerez Jerez#ping 192.168.2.1 Jerez Jerez#sh ip route Especificamos la ruta estatica para llegar desde la LAN de Jerez hasta la LAN de Granada Jerez Jerez>enable Jerez Jerez#conf terminal Jerez Jerez(config)#ip route ? Jerez Jerez(config)#ip route 192.168.2.0 ? Jerez Jerez(config)#ip route 192.168.2.0 255.255.255.128 Jerez Jerez(config)#ip route 192.168.2.0 255.255.255.128 ? Jerez Jerez(config)#ip route 192.168.2.0 255.255.255.128 192.168.3.2 Jerez Jerez(config)#end Jerez Jerez#sh ip route Jerez Jerez#conf terminal Jerez Jerez#sh ip route static Jerez Jerez#sh ip route connected Especificamos, esta vez, la ruta desde la LAN de Granada hasta Jerez Granada Granada>ena Granada Granada#conf ter Granada Granada(config)#ip route ? Granada Granada(config)#ip route 192.168.1.0 255.255. Granada Granada(config)#ip route 192.168.1.0 255.255.255.0 192.168.3.1 Granada Granada(config)#end Granada Granada#sh ip route Granada Granada>ena Una vez configurada la red interna de la empresa, toca ahora configurar la salida al exterior (al ISP) dando una IP al interfaz de salida del router (en este caso, es Granada) Granada Granada#conf ter Granada Granada(config)#interface serial 0/0/1 Granada Granada(config-if)#ip address 172.30.16.2 255.255.255.252 Granada Granada(config-if)#description serial to ISP Granada Granada(config-if)#no shutdown Granada Granada(config-if)#end Granada Granada#sh ip route Configuramos l\u00f3gicamente, el interfaz del ISP que conecta al exterior con la empresa ISP Router>ena ISP Router#conf terminal ISP Router(config)#hostname ISP ISP ISP(config)#interface serial 0/0/1 ISP ISP(config-if)#ip address 172.30.16.1 255.255.255.252 ISP ISP(config-if)#description serial to ASIR empresa ISP ISP(config-if)#no shutdown ISP ISP(config-if)#exit Configuramos dos interfaces de loopback como ejemplo ISP ISP(config)#interface loopback 1 ISP ISP(config-if)#ip address 193.147.162.1 255.255.255.0 ISP ISP(config-if)#interface loopback 2 ISP ISP(config-if)#ip address 8.8.8.8 255.255.255.0 ISP ISP(config-if)#end ISP ISP#sh run ISP ISP#ping 8.8.8.8 Por \u00faltimo, debemos configurar la ruta por defecto. Los routers mandan por esta ruta los paquetes con IPs que no se conozcan en la red interna. Esta ruta se configura en todos los routers de la red interna, con el objetivo de que sepan por qu\u00e9 camino mandar los paquetes con rutas desconocidas para ellos. Granada Granada#conf ter Granada Granada(config)#ip route 0.0.0.0 0.0.0.0 serial 0/0/1 //Es recomendable poner la ruta del siguiente salto en lugar del interfaz Granada Granada#sh ip route En el caso de Jerez, la ruta por defecto es la ruta hacia granada, pues es granada el router que conecta con el exterior Jerez Jerez>ena Jerez Jerez#sh ip route Jerez Jerez#conf ter Jerez Jerez(config)#ip route 0.0.0.0 0.0.0.0 192.168.3.2 Jerez Jerez(config)#end Jerez Jerez#sh ip route Jerez Jerez#conf ter Jerez Jerez(config)#no ip route 0.0.0.0 0.0.0.0 192.168.3.2 Jerez Jerez(config)#ip route 0.0.0.0 0.0.0.0 192.168.3.2 Adem\u00e1s, podemos agrupar direcciones para simplificar el enrutamiento desde el exterior a la empresa. En este caso, la empresa ten\u00eda un espacio de direcciones de /16 (255.255.0.0); por tanto todos los paquetes que tienen un 192.168.x.x, el ISP los manda por la IP 172.30.16.2, que es la IP que conecta el ISP con el router frontera (granada) ISP ISP#sh ip route ISP ISP#conf ter ISP ISP(config)#ip route 192.168.0.0 255.255.0.0 172.30.16.2 ISP ISP(config)#sh ip route ISP ISP(config)#end ISP ISP#sh ip route ISP ISP#sh ip route connected ISP ISP#sh run Esta parte, a priori, puede no tener sentido, \u00bf Por qu\u00e9 quita las rutas de las LAN de Granada ( 192.168.2.0/128) ? Si lo pensamos bien, todas la rutas de las LANs de Jerez, tanto sean conocidas como si no, se deben mandar al router de Granada, es por ello que podemos quitarlas sin problemas. Jerez Jerez(config)#end Jerez Jerez#sh ip route Jerez Jerez#sh ip route static Jerez Jerez#conf terminal Jerez Jerez(config)#end Jerez Jerez#sh run Jerez Jerez#conf ter Jerez Jerez(config)#no ip route 192.168.2.0 255.255.255.128 192.168.3.2 Jerez Jerez(config)#no ip route 192.168.2.128 255.255.255.128 192.168.3.2 Jerez Jerez(config)#end Jerez Jerez#sh ip route static","title":"**Enrutamiento estatico**"},{"location":"Estatico/#enrutamiento-estatico","text":"","title":"Enrutamiento estatico"},{"location":"Estatico/#ejemplo","text":"","title":"Ejemplo:"},{"location":"Estatico/#comandos-config-routing","text":"ANTES QUE TODO: ANOTAR LAS SUBREDES Y LAS DIRECCIONES IPs DE CADA LAN. En el router izquierdo (Jerez) configurar las interfaces gigabit seg\u00fan su correspondiente LAN Jerez Router>ena Jerez Router#conf terminal Jerez Router(config)#hostname Jerez Jerez Jerez(config)#interface gigabitEthernet 0/0 Jerez Jerez(config-if)#ip address 192.168.1.1 255.255.255.128 Jerez Jerez(config-if)#description LAN Cuartillo Jerez Jerez(config-if)#no shutdown Jerez Jerez(config-if)#interface gigabitEthernet 0/1 Jerez Jerez(config-if)#ip address 192.168.1.129 255.255.255.128 Jerez Jerez(config-if)#description LAN San Isidro Jerez Jerez(config-if)#no shutdown Jerez Jerez(config-if)#end Jerez Jerez#sh run Jerez Jerez#sh ip route Probamos algunos Ping hacia los host de las 2 LANs para comprobar la configuraci\u00f3n Jerez Jerez#ping 192.168.1.2 Jerez Jerez#ping 192.168.1.130 Jerez Jerez#sh ip route A continuaci\u00f3n, configuramos el router derecho (Granada) Granada Router>ena Granada Router#conf ter Granada Router(config)#hostname Granada Granada Granada(config)#interface gigabitEthernet 0/0 Granada Granada(config-if)#description Sierra Nevada Granada Granada(config-if)#ip address 192.168.2.1 255.255.255.128 Granada Granada(config-if)#no shutdown Granada Granada(config-if)#interface gigabitEthernet 0/1 Granada Granada(config-if)#description Generalife Granada Granada(config-if)#ip address 192.168.2.129 255.255.255.128 Granada Granada(config-if)#no shutdown Granada Granada(config-if)#end Granada Granada#sh running-config Granada Granada#sh ip route Ahora es el turno de la LAN entre los dos routers (el enlace punto a punto). Tenemos que configurar los dos extremos, uno en el router de Jerez y el otro en el de Granada Jerez Jerez#conf terminal Jerez Jerez(config)#interface serial 0/0/0 Jerez Jerez(config-if)#ip address 192.168.3.1 255.255.255.252 Jerez Jerez(config-if)#description Serial Jerez<->Granada Jerez Jerez(config-if)#no shutdown Jerez Jerez(config-if)#end Jerez Jerez#sh running-config Granada Granada#conf terminal Granada Granada(config)#interface serial 0/0/0 Granada Granada(config-if)#ip address 192.168.3.2 255.255.255.252 Granada Granada(config-if)#description Serial Granada-Jerez Granada Granada(config-if)#no shutdown Granada Granada(config-if)#end Granada Granada#sh ip route Ping al router de Granada Jerez Jerez#ping 192.168.3.2 Jerez Jerez#sh ip route Ping a uno de lo hosts de una LAN de Granada Jerez Jerez#ping 192.168.2.1 Jerez Jerez#sh ip route Especificamos la ruta estatica para llegar desde la LAN de Jerez hasta la LAN de Granada Jerez Jerez>enable Jerez Jerez#conf terminal Jerez Jerez(config)#ip route ? Jerez Jerez(config)#ip route 192.168.2.0 ? Jerez Jerez(config)#ip route 192.168.2.0 255.255.255.128 Jerez Jerez(config)#ip route 192.168.2.0 255.255.255.128 ? Jerez Jerez(config)#ip route 192.168.2.0 255.255.255.128 192.168.3.2 Jerez Jerez(config)#end Jerez Jerez#sh ip route Jerez Jerez#conf terminal Jerez Jerez#sh ip route static Jerez Jerez#sh ip route connected Especificamos, esta vez, la ruta desde la LAN de Granada hasta Jerez Granada Granada>ena Granada Granada#conf ter Granada Granada(config)#ip route ? Granada Granada(config)#ip route 192.168.1.0 255.255. Granada Granada(config)#ip route 192.168.1.0 255.255.255.0 192.168.3.1 Granada Granada(config)#end Granada Granada#sh ip route Granada Granada>ena Una vez configurada la red interna de la empresa, toca ahora configurar la salida al exterior (al ISP) dando una IP al interfaz de salida del router (en este caso, es Granada) Granada Granada#conf ter Granada Granada(config)#interface serial 0/0/1 Granada Granada(config-if)#ip address 172.30.16.2 255.255.255.252 Granada Granada(config-if)#description serial to ISP Granada Granada(config-if)#no shutdown Granada Granada(config-if)#end Granada Granada#sh ip route Configuramos l\u00f3gicamente, el interfaz del ISP que conecta al exterior con la empresa ISP Router>ena ISP Router#conf terminal ISP Router(config)#hostname ISP ISP ISP(config)#interface serial 0/0/1 ISP ISP(config-if)#ip address 172.30.16.1 255.255.255.252 ISP ISP(config-if)#description serial to ASIR empresa ISP ISP(config-if)#no shutdown ISP ISP(config-if)#exit Configuramos dos interfaces de loopback como ejemplo ISP ISP(config)#interface loopback 1 ISP ISP(config-if)#ip address 193.147.162.1 255.255.255.0 ISP ISP(config-if)#interface loopback 2 ISP ISP(config-if)#ip address 8.8.8.8 255.255.255.0 ISP ISP(config-if)#end ISP ISP#sh run ISP ISP#ping 8.8.8.8 Por \u00faltimo, debemos configurar la ruta por defecto. Los routers mandan por esta ruta los paquetes con IPs que no se conozcan en la red interna. Esta ruta se configura en todos los routers de la red interna, con el objetivo de que sepan por qu\u00e9 camino mandar los paquetes con rutas desconocidas para ellos. Granada Granada#conf ter Granada Granada(config)#ip route 0.0.0.0 0.0.0.0 serial 0/0/1 //Es recomendable poner la ruta del siguiente salto en lugar del interfaz Granada Granada#sh ip route En el caso de Jerez, la ruta por defecto es la ruta hacia granada, pues es granada el router que conecta con el exterior Jerez Jerez>ena Jerez Jerez#sh ip route Jerez Jerez#conf ter Jerez Jerez(config)#ip route 0.0.0.0 0.0.0.0 192.168.3.2 Jerez Jerez(config)#end Jerez Jerez#sh ip route Jerez Jerez#conf ter Jerez Jerez(config)#no ip route 0.0.0.0 0.0.0.0 192.168.3.2 Jerez Jerez(config)#ip route 0.0.0.0 0.0.0.0 192.168.3.2 Adem\u00e1s, podemos agrupar direcciones para simplificar el enrutamiento desde el exterior a la empresa. En este caso, la empresa ten\u00eda un espacio de direcciones de /16 (255.255.0.0); por tanto todos los paquetes que tienen un 192.168.x.x, el ISP los manda por la IP 172.30.16.2, que es la IP que conecta el ISP con el router frontera (granada) ISP ISP#sh ip route ISP ISP#conf ter ISP ISP(config)#ip route 192.168.0.0 255.255.0.0 172.30.16.2 ISP ISP(config)#sh ip route ISP ISP(config)#end ISP ISP#sh ip route ISP ISP#sh ip route connected ISP ISP#sh run Esta parte, a priori, puede no tener sentido, \u00bf Por qu\u00e9 quita las rutas de las LAN de Granada ( 192.168.2.0/128) ? Si lo pensamos bien, todas la rutas de las LANs de Jerez, tanto sean conocidas como si no, se deben mandar al router de Granada, es por ello que podemos quitarlas sin problemas. Jerez Jerez(config)#end Jerez Jerez#sh ip route Jerez Jerez#sh ip route static Jerez Jerez#conf terminal Jerez Jerez(config)#end Jerez Jerez#sh run Jerez Jerez#conf ter Jerez Jerez(config)#no ip route 192.168.2.0 255.255.255.128 192.168.3.2 Jerez Jerez(config)#no ip route 192.168.2.128 255.255.255.128 192.168.3.2 Jerez Jerez(config)#end Jerez Jerez#sh ip route static","title":"Comandos config routing"}]}